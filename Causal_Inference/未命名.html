
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Causal ML &#8212; Towards a Full-stack DA</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo2.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Towards a Full-stack DA</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Jace六边形DA笔记库
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  多元分析
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Analysis/Business.html">
   商业分析
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Analysis/DA.html">
   数据分析
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Analysis/STAT.html">
   统计分析
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  因果推断
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="README.html">
   基础
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_AB_testing.html">
   AB Test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_methods.html">
   因果推理方法
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  机器学习
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/README.html">
   基础
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/SupervisedML.html">
   有监督学习
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/UnsupervisedML.html">
   无监督学习
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  深度学习
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../DL/Basics/README.html">
   基础
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/Basics/DL_hyperparameter.html">
     DL常见超参及调整策略
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/Basics/Optimizer.html">
     优化器
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/Basics/Trained_by_GPU.html">
     GPU训练
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../DL/NLP/README.html">
   NLP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/NLP/basics.html">
     基础概念
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/NLP/Self-attention.html">
     Self-Attention
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/NLP/Transformer.html">
     Transformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DL/NLP/BERT.html">
     BERT
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../DL/NN_compression/README.html">
   神经网络压缩
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../DL/NN_compression/KD.html">
     知识蒸馏
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../DL/NN_compression/Distill_Bert.html">
       Distill Bert
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../DL/NN_compression/Quantize.html">
     量化
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../DL/NN_compression/QBert.html">
       Q-BERT
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  数据仓库
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../DE/README.html">
   基础概念
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../DE/SQL.html">
   SQL
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../DE/Data_cleaning/README.html">
   数据清洗与处理
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../DE/Data_cleaning/Regex.html">
     正则表达式
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../DE/Data_cleaning/pandas.html">
     Pandas
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  联系方式
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://www.linkedin.com/in/jinhang-yang/">
   LinkedIn
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Causal_Inference/未命名.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Jace-Yang/Full-Stack_Data-Analyst"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Jace-Yang/Full-Stack_Data-Analyst/issues/new?title=Issue%20on%20page%20%2FCausal_Inference/未命名.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Jace-Yang/Full-Stack_Data-Analyst/master?urlpath=tree/Causal_Inference/未命名.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Causal ML</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="causal-ml">
<h1>Causal ML<a class="headerlink" href="#causal-ml" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install causalml
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting causalml
  Using cached causalml-0.12.3.tar.gz (406 kB)
  Preparing metadata (setup.py) ... ?25ldone
?25hRequirement already satisfied: setuptools&gt;=41.0.0 in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from causalml) (62.3.2)
Requirement already satisfied: pip&gt;=10.0 in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from causalml) (22.1.1)
Collecting numpy&gt;=1.18.5
  Using cached numpy-1.22.4-cp310-cp310-macosx_11_0_arm64.whl (12.8 MB)
Collecting scipy&gt;=1.4.1
  Using cached scipy-1.8.1-cp310-cp310-macosx_12_0_arm64.whl (28.7 MB)
Collecting matplotlib
  Using cached matplotlib-3.5.2-cp310-cp310-macosx_11_0_arm64.whl (7.2 MB)
Collecting pandas&gt;=0.24.1
  Using cached pandas-1.4.2-cp310-cp310-macosx_11_0_arm64.whl (10.1 MB)
Collecting scikit-learn&gt;=0.22.0
  Using cached scikit_learn-1.1.1-cp310-cp310-macosx_12_0_arm64.whl (7.7 MB)
Collecting statsmodels&gt;=0.9.0
  Using cached statsmodels-0.13.2-cp310-cp310-macosx_11_0_arm64.whl (9.1 MB)
Collecting seaborn
  Using cached seaborn-0.11.2-py3-none-any.whl (292 kB)
Collecting Cython&gt;=0.28.0
  Using cached Cython-0.29.30-py2.py3-none-any.whl (985 kB)
Collecting xgboost
  Using cached xgboost-1.6.1-py3-none-macosx_12_0_arm64.whl (1.5 MB)
Collecting pydotplus
  Using cached pydotplus-2.0.2.tar.gz (278 kB)
  Preparing metadata (setup.py) ... ?25ldone
?25hCollecting tqdm
  Using cached tqdm-4.64.0-py2.py3-none-any.whl (78 kB)
Collecting shap
  Using cached shap-0.40.0-cp310-cp310-macosx_11_0_arm64.whl
Collecting dill
  Using cached dill-0.3.5.1-py2.py3-none-any.whl (95 kB)
Collecting lightgbm
  Using cached lightgbm-3.3.2-py3-none-any.whl
Collecting pygam
  Using cached pygam-0.8.0-py2.py3-none-any.whl (1.8 MB)
Requirement already satisfied: packaging in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from causalml) (21.3)
Collecting torch
  Downloading torch-1.11.0-cp310-none-macosx_11_0_arm64.whl (43.1 MB)
     <span class=" -Color -Color-Red">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Green">43.1/43.1 MB</span> <span class=" -Color -Color-Red">1.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>m eta <span class=" -Color -Color-Cyan">0:00:01</span>[36m0:00:01
?25hCollecting pyro-ppl
  Using cached pyro_ppl-1.8.1-py3-none-any.whl (718 kB)
Collecting graphviz
  Using cached graphviz-0.20-py3-none-any.whl (46 kB)
Requirement already satisfied: pytz&gt;=2020.1 in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from pandas&gt;=0.24.1-&gt;causalml) (2022.1)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from pandas&gt;=0.24.1-&gt;causalml) (2.8.2)
Collecting threadpoolctl&gt;=2.0.0
  Using cached threadpoolctl-3.1.0-py3-none-any.whl (14 kB)
Collecting joblib&gt;=1.0.0
  Using cached joblib-1.1.0-py2.py3-none-any.whl (306 kB)
Collecting patsy&gt;=0.5.2
  Using cached patsy-0.5.2-py2.py3-none-any.whl (233 kB)
Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from packaging-&gt;causalml) (3.0.9)
Requirement already satisfied: wheel in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from lightgbm-&gt;causalml) (0.37.1)
Collecting kiwisolver&gt;=1.0.1
  Using cached kiwisolver-1.4.2-cp310-cp310-macosx_11_0_arm64.whl (63 kB)
Collecting fonttools&gt;=4.22.0
  Using cached fonttools-4.33.3-py3-none-any.whl (930 kB)
Collecting cycler&gt;=0.10
  Using cached cycler-0.11.0-py3-none-any.whl (6.4 kB)
Collecting pillow&gt;=6.2.0
  Using cached Pillow-9.1.1-cp310-cp310-macosx_11_0_arm64.whl (2.8 MB)
Collecting future
  Using cached future-0.18.2.tar.gz (829 kB)
  Preparing metadata (setup.py) ... ?25ldone
?25hCollecting progressbar2
  Using cached progressbar2-4.0.0-py2.py3-none-any.whl (26 kB)
Collecting opt-einsum&gt;=2.3.2
  Using cached opt_einsum-3.3.0-py3-none-any.whl (65 kB)
Collecting pyro-api&gt;=0.1.1
  Using cached pyro_api-0.1.2-py3-none-any.whl (11 kB)
Collecting typing-extensions
  Using cached typing_extensions-4.2.0-py3-none-any.whl (24 kB)
Collecting cloudpickle
  Using cached cloudpickle-2.1.0-py3-none-any.whl (25 kB)
Collecting numba
  Using cached numba-0.55.2-cp310-cp310-macosx_11_0_arm64.whl (2.3 MB)
Collecting slicer==0.0.7
  Using cached slicer-0.0.7-py3-none-any.whl (14 kB)
Requirement already satisfied: six in /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages (from patsy&gt;=0.5.2-&gt;statsmodels&gt;=0.9.0-&gt;causalml) (1.16.0)
Collecting llvmlite&lt;0.39,&gt;=0.38.0rc1
  Using cached llvmlite-0.38.1-cp310-cp310-macosx_11_0_arm64.whl (23.1 MB)
Collecting python-utils&gt;=3.0.0
  Using cached python_utils-3.3.1-py2.py3-none-any.whl (22 kB)
Building wheels for collected packages: causalml, pydotplus, future
  Building wheel for causalml (setup.py) ... ?25lerror
  <span class=" -Color -Color-Bold -Color-Bold-Red">error</span>: <span class=" -Color -Color-Bold">subprocess-exited-with-error</span>
  
  <span class=" -Color -Color-Red">×</span> <span class=" -Color -Color-Green">python setup.py bdist_wheel</span> did not run successfully.
  <span class=" -Color -Color-Red">│</span> exit code: <span class=" -Color -Color-Bold -Color-Bold-Cyan">1</span>
  <span class=" -Color -Color-Red">╰─&gt;</span> <span class=" -Color -Color-Red">[33 lines of output]</span>
  <span class=" -Color -Color-Red">   </span> /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
  <span class=" -Color -Color-Red">   </span>   warnings.warn(
  <span class=" -Color -Color-Red">   </span> Traceback (most recent call last):
  <span class=" -Color -Color-Red">   </span>   File &quot;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/setup.py&quot;, line 13, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>     from numpy import get_include as np_get_include
  <span class=" -Color -Color-Red">   </span> ModuleNotFoundError: No module named &#39;numpy&#39;
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> During handling of the above exception, another exception occurred:
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> Traceback (most recent call last):
  <span class=" -Color -Color-Red">   </span>   File &quot;&lt;string&gt;&quot;, line 2, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>   File &quot;&lt;pip-setuptools-caller&gt;&quot;, line 34, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>   File &quot;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/setup.py&quot;, line 15, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>     dist.Distribution().fetch_build_eggs([&quot;numpy&quot;])
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/dist.py&quot;, line 876, in fetch_build_eggs
  <span class=" -Color -Color-Red">   </span>     resolved_dists = pkg_resources.working_set.resolve(
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/pkg_resources/__init__.py&quot;, line 789, in resolve
  <span class=" -Color -Color-Red">   </span>     dist = best[req.key] = env.best_match(
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/pkg_resources/__init__.py&quot;, line 1075, in best_match
  <span class=" -Color -Color-Red">   </span>     return self.obtain(req, installer)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/pkg_resources/__init__.py&quot;, line 1087, in obtain
  <span class=" -Color -Color-Red">   </span>     return installer(requirement)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/dist.py&quot;, line 956, in fetch_build_egg
  <span class=" -Color -Color-Red">   </span>     return fetch_build_egg(self, req)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/installer.py&quot;, line 87, in fetch_build_egg
  <span class=" -Color -Color-Red">   </span>     wheel.install_as_egg(dist_location)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/wheel.py&quot;, line 96, in install_as_egg
  <span class=" -Color -Color-Red">   </span>     self._install_as_egg(destination_eggdir, zf)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/wheel.py&quot;, line 104, in _install_as_egg
  <span class=" -Color -Color-Red">   </span>     self._convert_metadata(zf, destination_eggdir, dist_info, egg_info)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/wheel.py&quot;, line 148, in _convert_metadata
  <span class=" -Color -Color-Red">   </span>     os.rename(dist_info, egg_info)
  <span class=" -Color -Color-Red">   </span> OSError: [Errno 66] Directory not empty: &#39;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/.eggs/numpy-1.22.4-py3.10-macosx-11.0-arm64.egg/numpy-1.22.4.dist-info&#39; -&gt; &#39;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/.eggs/numpy-1.22.4-py3.10-macosx-11.0-arm64.egg/EGG-INFO&#39;
  <span class=" -Color -Color-Red">   </span> <span class=" -Color -Color-Red">[end of output]</span>
  
  <span class=" -Color -Color-Bold -Color-Bold-Magenta">note</span>: This error originates from a subprocess, and is likely not a problem with pip.
<span class=" -Color -Color-Red">  ERROR: Failed building wheel for causalml</span>
?25h  Running setup.py clean for causalml
  <span class=" -Color -Color-Bold -Color-Bold-Red">error</span>: <span class=" -Color -Color-Bold">subprocess-exited-with-error</span>
  
  <span class=" -Color -Color-Red">×</span> <span class=" -Color -Color-Green">python setup.py clean</span> did not run successfully.
  <span class=" -Color -Color-Red">│</span> exit code: <span class=" -Color -Color-Bold -Color-Bold-Cyan">1</span>
  <span class=" -Color -Color-Red">╰─&gt;</span> <span class=" -Color -Color-Red">[33 lines of output]</span>
  <span class=" -Color -Color-Red">   </span> /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
  <span class=" -Color -Color-Red">   </span>   warnings.warn(
  <span class=" -Color -Color-Red">   </span> Traceback (most recent call last):
  <span class=" -Color -Color-Red">   </span>   File &quot;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/setup.py&quot;, line 13, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>     from numpy import get_include as np_get_include
  <span class=" -Color -Color-Red">   </span> ModuleNotFoundError: No module named &#39;numpy&#39;
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> During handling of the above exception, another exception occurred:
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> Traceback (most recent call last):
  <span class=" -Color -Color-Red">   </span>   File &quot;&lt;string&gt;&quot;, line 2, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>   File &quot;&lt;pip-setuptools-caller&gt;&quot;, line 34, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>   File &quot;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/setup.py&quot;, line 15, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>     dist.Distribution().fetch_build_eggs([&quot;numpy&quot;])
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/dist.py&quot;, line 876, in fetch_build_eggs
  <span class=" -Color -Color-Red">   </span>     resolved_dists = pkg_resources.working_set.resolve(
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/pkg_resources/__init__.py&quot;, line 789, in resolve
  <span class=" -Color -Color-Red">   </span>     dist = best[req.key] = env.best_match(
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/pkg_resources/__init__.py&quot;, line 1075, in best_match
  <span class=" -Color -Color-Red">   </span>     return self.obtain(req, installer)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/pkg_resources/__init__.py&quot;, line 1087, in obtain
  <span class=" -Color -Color-Red">   </span>     return installer(requirement)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/dist.py&quot;, line 956, in fetch_build_egg
  <span class=" -Color -Color-Red">   </span>     return fetch_build_egg(self, req)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/installer.py&quot;, line 87, in fetch_build_egg
  <span class=" -Color -Color-Red">   </span>     wheel.install_as_egg(dist_location)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/wheel.py&quot;, line 96, in install_as_egg
  <span class=" -Color -Color-Red">   </span>     self._install_as_egg(destination_eggdir, zf)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/wheel.py&quot;, line 104, in _install_as_egg
  <span class=" -Color -Color-Red">   </span>     self._convert_metadata(zf, destination_eggdir, dist_info, egg_info)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/setuptools/wheel.py&quot;, line 148, in _convert_metadata
  <span class=" -Color -Color-Red">   </span>     os.rename(dist_info, egg_info)
  <span class=" -Color -Color-Red">   </span> OSError: [Errno 66] Directory not empty: &#39;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/.eggs/numpy-1.22.4-py3.10-macosx-11.0-arm64.egg/numpy-1.22.4.dist-info&#39; -&gt; &#39;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/.eggs/numpy-1.22.4-py3.10-macosx-11.0-arm64.egg/EGG-INFO&#39;
  <span class=" -Color -Color-Red">   </span> <span class=" -Color -Color-Red">[end of output]</span>
  
  <span class=" -Color -Color-Bold -Color-Bold-Magenta">note</span>: This error originates from a subprocess, and is likely not a problem with pip.
<span class=" -Color -Color-Red">  ERROR: Failed cleaning build dir for causalml</span>
  Building wheel for pydotplus (setup.py) ... ?25ldone
?25h  Created wheel for pydotplus: filename=pydotplus-2.0.2-py3-none-any.whl size=24554 sha256=08d12c75d9f00e1bbfee80979d3343457e42bd21687c3703729fd3e715e6a715
  Stored in directory: /Users/jace/Library/Caches/pip/wheels/69/b2/67/08f0eef649af92df772c09f451558298e07fab1bc7cdf33db0
  Building wheel for future (setup.py) ... ?25ldone
?25h  Created wheel for future: filename=future-0.18.2-py3-none-any.whl size=491058 sha256=a583a6c54091b23bf5c0b7d80b5bdd69bc909de5bbb992052b87564620b29596
  Stored in directory: /Users/jace/Library/Caches/pip/wheels/22/73/06/557dc4f4ef68179b9d763930d6eec26b88ed7c389b19588a1c
Successfully built pydotplus future
Failed to build causalml
Installing collected packages: pyro-api, typing-extensions, tqdm, threadpoolctl, slicer, python-utils, pydotplus, pillow, numpy, llvmlite, kiwisolver, joblib, graphviz, future, fonttools, dill, Cython, cycler, cloudpickle, torch, scipy, progressbar2, patsy, pandas, opt-einsum, numba, matplotlib, xgboost, statsmodels, seaborn, scikit-learn, pyro-ppl, pygam, shap, lightgbm, causalml
  Running setup.py install for causalml ... ?25lerror
  <span class=" -Color -Color-Bold -Color-Bold-Red">error</span>: <span class=" -Color -Color-Bold">subprocess-exited-with-error</span>
  
  <span class=" -Color -Color-Red">×</span> <span class=" -Color -Color-Green">Running setup.py install for causalml</span> did not run successfully.
  <span class=" -Color -Color-Red">│</span> exit code: <span class=" -Color -Color-Bold -Color-Bold-Cyan">1</span>
  <span class=" -Color -Color-Red">╰─&gt;</span> <span class=" -Color -Color-Red">[57 lines of output]</span>
  <span class=" -Color -Color-Red">   </span> Compiling causalml/inference/tree/causaltree.pyx because it depends on /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/sklearn/tree/_criterion.pxd.
  <span class=" -Color -Color-Red">   </span> Compiling causalml/inference/tree/uplift.pyx because it depends on /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/Cython/Includes/libc/string.pxd.
  <span class=" -Color -Color-Red">   </span> [1/2] Cythonizing causalml/inference/tree/causaltree.pyx
  <span class=" -Color -Color-Red">   </span> /Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive &#39;language_level&#39; not set, using 2 for now (Py2). This will change in a later release! File: /private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/causalml/inference/tree/causaltree.pyx
  <span class=" -Color -Color-Red">   </span>   tree = Parsing.p_module(s, pxd, full_module_name)
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> Error compiling Cython file:
  <span class=" -Color -Color-Red">   </span> ------------------------------------------------------------
  <span class=" -Color -Color-Red">   </span> ...
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span>     cdef double node_impurity(self) nogil:
  <span class=" -Color -Color-Red">   </span>         &quot;&quot;&quot;Evaluate the impurity of the current node, i.e. the impurity of
  <span class=" -Color -Color-Red">   </span>            samples[start:end].&quot;&quot;&quot;
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span>         cdef double* sum_total = self.sum_total
  <span class=" -Color -Color-Red">   </span>                                     ^
  <span class=" -Color -Color-Red">   </span> ------------------------------------------------------------
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> causalml/inference/tree/causaltree.pyx:77:37: Cannot assign type &#39;double[::1]&#39; to &#39;double *&#39;
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> Error compiling Cython file:
  <span class=" -Color -Color-Red">   </span> ------------------------------------------------------------
  <span class=" -Color -Color-Red">   </span> ...
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t* samples = self.samples
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t start = self.start
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t pos = self.pos
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t end = self.end
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span>         cdef double* sum_left = self.sum_left
  <span class=" -Color -Color-Red">   </span>                                    ^
  <span class=" -Color -Color-Red">   </span> ------------------------------------------------------------
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> causalml/inference/tree/causaltree.pyx:135:36: Cannot assign type &#39;double[::1]&#39; to &#39;double *&#39;
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> Error compiling Cython file:
  <span class=" -Color -Color-Red">   </span> ------------------------------------------------------------
  <span class=" -Color -Color-Red">   </span> ...
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t start = self.start
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t pos = self.pos
  <span class=" -Color -Color-Red">   </span>         cdef SIZE_t end = self.end
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span>         cdef double* sum_left = self.sum_left
  <span class=" -Color -Color-Red">   </span>         cdef double* sum_right = self.sum_right
  <span class=" -Color -Color-Red">   </span>                                     ^
  <span class=" -Color -Color-Red">   </span> ------------------------------------------------------------
  <span class=" -Color -Color-Red">   </span> 
  <span class=" -Color -Color-Red">   </span> causalml/inference/tree/causaltree.pyx:136:37: Cannot assign type &#39;double[::1]&#39; to &#39;double *&#39;
  <span class=" -Color -Color-Red">   </span> Traceback (most recent call last):
  <span class=" -Color -Color-Red">   </span>   File &quot;&lt;string&gt;&quot;, line 2, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>   File &quot;&lt;pip-setuptools-caller&gt;&quot;, line 34, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>   File &quot;/private/var/folders/vn/78yrfhs92slfj6nr61fhb9w00000gn/T/pip-install-kwbmvzdd/causalml_d42ece055c2d45bd91ed21dc74796834/setup.py&quot;, line 71, in &lt;module&gt;
  <span class=" -Color -Color-Red">   </span>     ext_modules=cythonize(extensions, annotate=True),
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/Cython/Build/Dependencies.py&quot;, line 1127, in cythonize
  <span class=" -Color -Color-Red">   </span>     cythonize_one(*args)
  <span class=" -Color -Color-Red">   </span>   File &quot;/Users/jace/opt/anaconda3/envs/DL/causalml/lib/python3.10/site-packages/Cython/Build/Dependencies.py&quot;, line 1250, in cythonize_one
  <span class=" -Color -Color-Red">   </span>     raise CompileError(None, pyx_file)
  <span class=" -Color -Color-Red">   </span> Cython.Compiler.Errors.CompileError: causalml/inference/tree/causaltree.pyx
  <span class=" -Color -Color-Red">   </span> <span class=" -Color -Color-Red">[end of output]</span>
  
  <span class=" -Color -Color-Bold -Color-Bold-Magenta">note</span>: This error originates from a subprocess, and is likely not a problem with pip.
<span class=" -Color -Color-Bold -Color-Bold-Red">error</span>: <span class=" -Color -Color-Bold">legacy-install-failure</span>

<span class=" -Color -Color-Red">×</span> Encountered error while trying to install package.
<span class=" -Color -Color-Red">╰─&gt;</span> causalml

<span class=" -Color -Color-Bold -Color-Bold-Magenta">note</span>: This is an issue with the package mentioned above, not pip.
<span class=" -Color -Color-Bold -Color-Bold-Cyan">hint</span>: See above for output from the failure.
?25h
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip list
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Package                       Version
----------------------------- -----------
anyio                         3.6.1
appnope                       0.1.3
argon2-cffi                   21.3.0
argon2-cffi-bindings          21.2.0
asttokens                     2.0.5
attrs                         21.4.0
Babel                         2.10.1
backcall                      0.2.0
backports.functools-lru-cache 1.6.4
beautifulsoup4                4.11.1
bleach                        5.0.0
brotlipy                      0.7.0
certifi                       2022.5.18.1
cffi                          1.15.0
charset-normalizer            2.0.12
cloudpickle                   2.1.0
cryptography                  37.0.2
cycler                        0.11.0
Cython                        0.29.30
debugpy                       1.6.0
decorator                     5.1.1
defusedxml                    0.7.1
dill                          0.3.5.1
entrypoints                   0.4
executing                     0.8.3
fastjsonschema                2.15.3
flit_core                     3.7.1
fonttools                     4.33.3
future                        0.18.2
graphviz                      0.20
idna                          3.3
importlib-metadata            4.11.4
importlib-resources           5.7.1
ipykernel                     6.13.0
ipython                       8.4.0
ipython-genutils              0.2.0
jedi                          0.18.1
Jinja2                        3.1.2
joblib                        1.1.0
json5                         0.9.5
jsonschema                    4.5.1
jupyter-client                7.3.1
jupyter-core                  4.10.0
jupyter-lsp                   1.5.1
jupyter-server                1.17.0
jupyterlab                    3.4.2
jupyterlab-lsp                3.10.1
jupyterlab-pygments           0.2.2
jupyterlab-server             2.14.0
kiwisolver                    1.4.2
lightgbm                      3.3.2
llvmlite                      0.38.1
MarkupSafe                    2.1.1
matplotlib                    3.5.2
matplotlib-inline             0.1.3
mistune                       0.8.4
nbclassic                     0.3.7
nbclient                      0.6.3
nbconvert                     6.5.0
nbformat                      5.4.0
nest-asyncio                  1.5.5
notebook                      6.4.11
notebook-shim                 0.1.0
numba                         0.55.2
numpy                         1.22.4
opt-einsum                    3.3.0
packaging                     21.3
pandas                        1.4.2
pandocfilters                 1.5.0
parso                         0.8.3
patsy                         0.5.2
pexpect                       4.8.0
pickleshare                   0.7.5
Pillow                        9.1.1
pip                           22.1.1
progressbar2                  4.0.0
prometheus-client             0.14.1
prompt-toolkit                3.0.29
psutil                        5.9.1
ptyprocess                    0.7.0
pure-eval                     0.2.2
pycparser                     2.21
pydotplus                     2.0.2
pygam                         0.8.0
Pygments                      2.12.0
pyOpenSSL                     22.0.0
pyparsing                     3.0.9
pyro-api                      0.1.2
pyro-ppl                      1.8.1
pyrsistent                    0.18.1
PySocks                       1.7.1
python-dateutil               2.8.2
python-utils                  3.3.1
pytz                          2022.1
pyzmq                         23.0.0
requests                      2.27.1
scikit-learn                  1.1.1
scipy                         1.8.1
seaborn                       0.11.2
Send2Trash                    1.8.0
setuptools                    62.3.2
shap                          0.40.0
six                           1.16.0
slicer                        0.0.7
sniffio                       1.2.0
soupsieve                     2.3.1
stack-data                    0.2.0
statsmodels                   0.13.2
terminado                     0.15.0
threadpoolctl                 3.1.0
tinycss2                      1.1.1
torch                         1.11.0
tornado                       6.1
tqdm                          4.64.0
traitlets                     5.2.1.post0
typing_extensions             4.2.0
urllib3                       1.26.9
wcwidth                       0.2.5
webencodings                  0.5.1
websocket-client              1.3.2
wheel                         0.37.1
xgboost                       1.6.1
zipp                          3.8.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">causalml.inference.meta</span> <span class="kn">import</span> <span class="n">BasesRegressor</span> 
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">causalml.inference.meta</span> <span class="kn">import</span> <span class="n">BasesRegressor</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;causalml&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">treatment</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">e</span> <span class="n">synthetic_data</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">N_SAMPLES</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">N_FEATURES</span><span class="p">)</span>
<span class="n">X_multi</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;treatment_A&#39;</span><span class="k">if</span> <span class="n">x</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;control&#39;</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">treatment</span><span class="p">])</span>
<span class="n">learner_s</span> <span class="n">BaseSRegressor</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">XGBRegressor</span><span class="p">())</span>
<span class="n">cate_s</span> <span class="n">learner_s</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="n">treatment</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Causal_Inference"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Jace Yang<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>